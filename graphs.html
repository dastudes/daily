<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baseball Graphs Daily</title>
    <link rel="icon" href="favicon.png">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: Georgia, "Times New Roman", serif;
            background: #F0F0F0;
            color: #2F2F2F;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 960px !important;
            margin: 0 auto !important;
            padding: 0 20px;
        }
        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #1e3a8a 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .breadcrumb {
            text-align: left;
            margin-bottom: 15px;
        }
        .breadcrumb a {
            color: #2563eb;
            text-decoration: none;
            font-size: 1.2em;
        }
        .breadcrumb a:hover {
            text-decoration: underline;
            color: #1e40af;
        }
        .breadcrumb a::before {
            content: "← ";
        }
        .about-section {
            background: white;
            border: 2px solid #1e3a8a;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .about-section details {
            cursor: pointer;
        }
        .about-section summary {
            font-weight: bold;
            font-size: 1.1em;
            color: #1e3a8a;
            padding: 5px;
        }
        .about-section .content {
            margin-top: 10px;
            line-height: 1.6;
        }
        .league-selector {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 10px;
        }
        .league-selector label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
        }
        .league-selector input[type="radio"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        .standings-box {
            background: white;
            border: 4px solid #1e3a8a;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .standings-box h2 {
            text-align: center;
            font-size: 1.8em;
            margin-bottom: 15px;
            color: #2F2F2F;
        }
        .tab-container {
            background: white;
            border: 4px solid #888;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .tab-buttons {
            display: flex;
            border-bottom: 4px solid #888;
        }
        .tab-button {
            flex: 1;
            padding: 12px;
            font-weight: bold;
            font-size: 1.1em;
            background: #d0d0d0;
            border: none;
            border-right: 2px solid #888;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .tab-button:last-child {
            border-right: none;
        }
        .tab-button.active {
            background: white;
        }
        .tab-button:hover:not(.active) {
            background: #c0c0c0;
        }
        .tab-content {
            padding: 20px;
        }
        .tab-content.bg-red-50 {
            background-color: #fef2f2;
        }
        .tab-content.bg-blue-50 {
            background-color: #eff6ff;
        }
        .tab-content.bg-green-50 {
            background-color: #f0fdf4;
        }
        .chart-container {
            position: relative;
            height: 500px;
            margin: 20px 0;
        }
        .graph-info {
            margin-top: 15px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }
        .graph-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        .about-graph {
            flex: 1;
        }
        .about-graph details {
            cursor: pointer;
        }
        .about-graph summary {
            font-weight: bold;
            color: #2563eb;
            padding: 5px;
        }
        .about-graph .content {
            margin-top: 10px;
            line-height: 1.6;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 5px;
        }
        .download-link {
            display: block;
            text-align: right;
            font-size: 0.85em;
            color: #2563eb;
            text-decoration: underline;
            cursor: pointer;
            margin-bottom: 5px;
        }
        .download-link:hover {
            color: #1e40af;
        }
        .footer-note {
            text-align: center;
            color: #666;
            font-size: 0.85em;
            margin-top: 10px;
        }
        /* Standings table numeric columns use monospace for alignment */
        .standings-table td:not(:first-child),
        .standings-table th:not(:first-child) {
            font-family: "Courier New", Courier, monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="breadcrumb">
            <a href="https://www.baseballgraphs.com/">To the Historic Baseball Graphs Page</a>
        </div>
        
        <div class="header">
            <h1>Baseball Graphs Daily</h1>
            <div style="margin-top: 10px; font-size: 0.9em;">2025 Season - Updated: Thursday, January 15, 2026 at 6:17 PM EST</div>
        </div>
        
        <div class="about-section">
            <details>
                <summary>About These Graphs</summary>
                <div class="content">
                    <p><strong>Welcome to Baseball Graphs Daily!</strong></p>
                    <p>This page automatically updates each morning with the latest MLB standings and three analytical graphs that help understand team performance.</p>
                    <p>The <strong>Run Differential</strong> graph shows how teams perform offensively and defensively, with Pythagorean win expectancy lines. The <strong>Offensive Profile</strong> graph examines how teams score runs through on-base percentage and power. The <strong>Pitching & Defense</strong> graph separates pitching quality (FIP) from fielding effectiveness (DER).</p>
                    <p>Select American League or National League to view standings and graphs for that league. Click the tabs to switch between the three graphs. For detailed player statistics, visit our <a href="index.html" style="color: #2563eb; text-decoration: underline;">Daily Stats page</a>.</p>
                </div>
            </details>
        </div>
        
        <div class="standings-box">
            <div class="league-selector">
                <label>
                    <input type="radio" name="league" value="AL" checked onchange="updateLeague()">
                    American League
                </label>
                <label>
                    <input type="radio" name="league" value="NL" onchange="updateLeague()">
                    National League
                </label>
            </div>
            
            <div id="alStandings">
                <h2>2025 American League Standings</h2>
                <div class="mb-4"><h3 class="text-lg font-semibold text-gray-800 mb-1">American League East</h3><table class="standings-table w-full text-gray-800 text-sm"><thead><tr class="border-b-2 border-blue-800"><th class="text-left py-1 px-2" style="width: 30%;">Team</th><th class="text-right py-1 px-2" style="width: 7%;">W</th><th class="text-right py-1 px-2" style="width: 7%;">L</th><th class="text-right py-1 px-2" style="width: 7%;">GB</th><th class="text-right py-1 px-2" style="width: 7%;">WC</th><th class="text-right py-1 px-2" style="width: 9%;">PCT</th><th class="text-right py-1 px-2" style="width: 11%;">PythVar</th><th class="text-right py-1 px-2" style="width: 9%;">RS</th><th class="text-right py-1 px-2" style="width: 9%;">RA</th></tr></thead><tbody class="text-sm"><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/blue-jays" target="_blank" style="color: #2563eb; text-decoration: underline;">Toronto Blue Jays</a>-z</td><td class="text-right py-0 px-2">94</td><td class="text-right py-0 px-2">68</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">.580</td><td class="text-right py-0 px-2">4.8</td><td class="text-right py-0 px-2">798</td><td class="text-right py-0 px-2">721</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/yankees" target="_blank" style="color: #2563eb; text-decoration: underline;">New York Yankees</a>-w</td><td class="text-right py-0 px-2">94</td><td class="text-right py-0 px-2">68</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">1</td><td class="text-right py-0 px-2">.580</td><td class="text-right py-0 px-2">-4.1</td><td class="text-right py-0 px-2">849</td><td class="text-right py-0 px-2">685</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/red-sox" target="_blank" style="color: #2563eb; text-decoration: underline;">Boston Red Sox</a>-w</td><td class="text-right py-0 px-2">89</td><td class="text-right py-0 px-2">73</td><td class="text-right py-0 px-2">5.0</td><td class="text-right py-0 px-2">2</td><td class="text-right py-0 px-2">.549</td><td class="text-right py-0 px-2">-4.1</td><td class="text-right py-0 px-2">786</td><td class="text-right py-0 px-2">676</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/rays" target="_blank" style="color: #2563eb; text-decoration: underline;">Tampa Bay Rays</a></td><td class="text-right py-0 px-2">77</td><td class="text-right py-0 px-2">85</td><td class="text-right py-0 px-2">17.0</td><td class="text-right py-0 px-2">7</td><td class="text-right py-0 px-2">.475</td><td class="text-right py-0 px-2">-7.6</td><td class="text-right py-0 px-2">714</td><td class="text-right py-0 px-2">683</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/orioles" target="_blank" style="color: #2563eb; text-decoration: underline;">Baltimore Orioles</a></td><td class="text-right py-0 px-2">75</td><td class="text-right py-0 px-2">87</td><td class="text-right py-0 px-2">19.0</td><td class="text-right py-0 px-2">9</td><td class="text-right py-0 px-2">.463</td><td class="text-right py-0 px-2">6.2</td><td class="text-right py-0 px-2">677</td><td class="text-right py-0 px-2">788</td></tr></tbody></table></div><div class="mb-4"><h3 class="text-lg font-semibold text-gray-800 mb-1">American League Central</h3><table class="standings-table w-full text-gray-800 text-sm"><thead><tr class="border-b-2 border-blue-800"><th class="text-left py-1 px-2" style="width: 30%;">Team</th><th class="text-right py-1 px-2" style="width: 7%;">W</th><th class="text-right py-1 px-2" style="width: 7%;">L</th><th class="text-right py-1 px-2" style="width: 7%;">GB</th><th class="text-right py-1 px-2" style="width: 7%;">WC</th><th class="text-right py-1 px-2" style="width: 9%;">PCT</th><th class="text-right py-1 px-2" style="width: 11%;">PythVar</th><th class="text-right py-1 px-2" style="width: 9%;">RS</th><th class="text-right py-1 px-2" style="width: 9%;">RA</th></tr></thead><tbody class="text-sm"><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/guardians" target="_blank" style="color: #2563eb; text-decoration: underline;">Cleveland Guardians</a>-y</td><td class="text-right py-0 px-2">88</td><td class="text-right py-0 px-2">74</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">.543</td><td class="text-right py-0 px-2">7.8</td><td class="text-right py-0 px-2">643</td><td class="text-right py-0 px-2">649</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/tigers" target="_blank" style="color: #2563eb; text-decoration: underline;">Detroit Tigers</a>-w</td><td class="text-right py-0 px-2">87</td><td class="text-right py-0 px-2">75</td><td class="text-right py-0 px-2">1.0</td><td class="text-right py-0 px-2">4</td><td class="text-right py-0 px-2">.537</td><td class="text-right py-0 px-2">-1.5</td><td class="text-right py-0 px-2">758</td><td class="text-right py-0 px-2">691</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/royals" target="_blank" style="color: #2563eb; text-decoration: underline;">Kansas City Royals</a></td><td class="text-right py-0 px-2">82</td><td class="text-right py-0 px-2">80</td><td class="text-right py-0 px-2">6.0</td><td class="text-right py-0 px-2">5</td><td class="text-right py-0 px-2">.506</td><td class="text-right py-0 px-2">-0.8</td><td class="text-right py-0 px-2">651</td><td class="text-right py-0 px-2">637</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/twins" target="_blank" style="color: #2563eb; text-decoration: underline;">Minnesota Twins</a></td><td class="text-right py-0 px-2">70</td><td class="text-right py-0 px-2">92</td><td class="text-right py-0 px-2">18.0</td><td class="text-right py-0 px-2">11</td><td class="text-right py-0 px-2">.432</td><td class="text-right py-0 px-2">-0.4</td><td class="text-right py-0 px-2">678</td><td class="text-right py-0 px-2">773</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/white-sox" target="_blank" style="color: #2563eb; text-decoration: underline;">Chicago White Sox</a></td><td class="text-right py-0 px-2">60</td><td class="text-right py-0 px-2">102</td><td class="text-right py-0 px-2">28.0</td><td class="text-right py-0 px-2">12</td><td class="text-right py-0 px-2">.370</td><td class="text-right py-0 px-2">-10.0</td><td class="text-right py-0 px-2">647</td><td class="text-right py-0 px-2">742</td></tr></tbody></table></div><div class="mb-4"><h3 class="text-lg font-semibold text-gray-800 mb-1">American League West</h3><table class="standings-table w-full text-gray-800 text-sm"><thead><tr class="border-b-2 border-blue-800"><th class="text-left py-1 px-2" style="width: 30%;">Team</th><th class="text-right py-1 px-2" style="width: 7%;">W</th><th class="text-right py-1 px-2" style="width: 7%;">L</th><th class="text-right py-1 px-2" style="width: 7%;">GB</th><th class="text-right py-1 px-2" style="width: 7%;">WC</th><th class="text-right py-1 px-2" style="width: 9%;">PCT</th><th class="text-right py-1 px-2" style="width: 11%;">PythVar</th><th class="text-right py-1 px-2" style="width: 9%;">RS</th><th class="text-right py-1 px-2" style="width: 9%;">RA</th></tr></thead><tbody class="text-sm"><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/mariners" target="_blank" style="color: #2563eb; text-decoration: underline;">Seattle Mariners</a>-y</td><td class="text-right py-0 px-2">90</td><td class="text-right py-0 px-2">72</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">.556</td><td class="text-right py-0 px-2">1.0</td><td class="text-right py-0 px-2">766</td><td class="text-right py-0 px-2">694</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/astros" target="_blank" style="color: #2563eb; text-decoration: underline;">Houston Astros</a></td><td class="text-right py-0 px-2">87</td><td class="text-right py-0 px-2">75</td><td class="text-right py-0 px-2">3.0</td><td class="text-right py-0 px-2">3</td><td class="text-right py-0 px-2">.537</td><td class="text-right py-0 px-2">3.5</td><td class="text-right py-0 px-2">686</td><td class="text-right py-0 px-2">665</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/rangers" target="_blank" style="color: #2563eb; text-decoration: underline;">Texas Rangers</a></td><td class="text-right py-0 px-2">81</td><td class="text-right py-0 px-2">81</td><td class="text-right py-0 px-2">9.0</td><td class="text-right py-0 px-2">6</td><td class="text-right py-0 px-2">.500</td><td class="text-right py-0 px-2">-9.9</td><td class="text-right py-0 px-2">684</td><td class="text-right py-0 px-2">605</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/ath" target="_blank" style="color: #2563eb; text-decoration: underline;">Athletics</a></td><td class="text-right py-0 px-2">76</td><td class="text-right py-0 px-2">86</td><td class="text-right py-0 px-2">14.0</td><td class="text-right py-0 px-2">8</td><td class="text-right py-0 px-2">.469</td><td class="text-right py-0 px-2">3.8</td><td class="text-right py-0 px-2">733</td><td class="text-right py-0 px-2">817</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/angels" target="_blank" style="color: #2563eb; text-decoration: underline;">Los Angeles Angels</a></td><td class="text-right py-0 px-2">72</td><td class="text-right py-0 px-2">90</td><td class="text-right py-0 px-2">18.0</td><td class="text-right py-0 px-2">10</td><td class="text-right py-0 px-2">.444</td><td class="text-right py-0 px-2">8.4</td><td class="text-right py-0 px-2">673</td><td class="text-right py-0 px-2">837</td></tr></tbody></table></div>
                <div class="footer-note">
                    <strong>z</strong>=Clinched Division &amp; Best Record | <strong>y</strong>=Clinched Division | <strong>w</strong>=Clinched Wild Card<br>
                    WC = Wild Card Rank | PythVar = Actual Wins − Pythagorean Expected Wins
                </div>
            </div>
            
            <div id="nlStandings" style="display: none;">
                <h2>2025 National League Standings</h2>
                <div class="mb-4"><h3 class="text-lg font-semibold text-gray-800 mb-1">National League East</h3><table class="standings-table w-full text-gray-800 text-sm"><thead><tr class="border-b-2 border-blue-800"><th class="text-left py-1 px-2" style="width: 30%;">Team</th><th class="text-right py-1 px-2" style="width: 7%;">W</th><th class="text-right py-1 px-2" style="width: 7%;">L</th><th class="text-right py-1 px-2" style="width: 7%;">GB</th><th class="text-right py-1 px-2" style="width: 7%;">WC</th><th class="text-right py-1 px-2" style="width: 9%;">PCT</th><th class="text-right py-1 px-2" style="width: 11%;">PythVar</th><th class="text-right py-1 px-2" style="width: 9%;">RS</th><th class="text-right py-1 px-2" style="width: 9%;">RA</th></tr></thead><tbody class="text-sm"><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/phillies" target="_blank" style="color: #2563eb; text-decoration: underline;">Philadelphia Phillies</a>-y</td><td class="text-right py-0 px-2">96</td><td class="text-right py-0 px-2">66</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">.593</td><td class="text-right py-0 px-2">0.4</td><td class="text-right py-0 px-2">778</td><td class="text-right py-0 px-2">648</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/mets" target="_blank" style="color: #2563eb; text-decoration: underline;">New York Mets</a></td><td class="text-right py-0 px-2">83</td><td class="text-right py-0 px-2">79</td><td class="text-right py-0 px-2">13.0</td><td class="text-right py-0 px-2">3</td><td class="text-right py-0 px-2">.512</td><td class="text-right py-0 px-2">-3.6</td><td class="text-right py-0 px-2">766</td><td class="text-right py-0 px-2">715</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/marlins" target="_blank" style="color: #2563eb; text-decoration: underline;">Miami Marlins</a></td><td class="text-right py-0 px-2">79</td><td class="text-right py-0 px-2">83</td><td class="text-right py-0 px-2">17.0</td><td class="text-right py-0 px-2">7</td><td class="text-right py-0 px-2">.488</td><td class="text-right py-0 px-2">7.5</td><td class="text-right py-0 px-2">709</td><td class="text-right py-0 px-2">798</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/braves" target="_blank" style="color: #2563eb; text-decoration: underline;">Atlanta Braves</a></td><td class="text-right py-0 px-2">76</td><td class="text-right py-0 px-2">86</td><td class="text-right py-0 px-2">20.0</td><td class="text-right py-0 px-2">9</td><td class="text-right py-0 px-2">.469</td><td class="text-right py-0 px-2">-3.9</td><td class="text-right py-0 px-2">724</td><td class="text-right py-0 px-2">734</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/nationals" target="_blank" style="color: #2563eb; text-decoration: underline;">Washington Nationals</a></td><td class="text-right py-0 px-2">66</td><td class="text-right py-0 px-2">96</td><td class="text-right py-0 px-2">30.0</td><td class="text-right py-0 px-2">11</td><td class="text-right py-0 px-2">.407</td><td class="text-right py-0 px-2">6.3</td><td class="text-right py-0 px-2">687</td><td class="text-right py-0 px-2">899</td></tr></tbody></table></div><div class="mb-4"><h3 class="text-lg font-semibold text-gray-800 mb-1">National League Central</h3><table class="standings-table w-full text-gray-800 text-sm"><thead><tr class="border-b-2 border-blue-800"><th class="text-left py-1 px-2" style="width: 30%;">Team</th><th class="text-right py-1 px-2" style="width: 7%;">W</th><th class="text-right py-1 px-2" style="width: 7%;">L</th><th class="text-right py-1 px-2" style="width: 7%;">GB</th><th class="text-right py-1 px-2" style="width: 7%;">WC</th><th class="text-right py-1 px-2" style="width: 9%;">PCT</th><th class="text-right py-1 px-2" style="width: 11%;">PythVar</th><th class="text-right py-1 px-2" style="width: 9%;">RS</th><th class="text-right py-1 px-2" style="width: 9%;">RA</th></tr></thead><tbody class="text-sm"><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/brewers" target="_blank" style="color: #2563eb; text-decoration: underline;">Milwaukee Brewers</a>-z</td><td class="text-right py-0 px-2">97</td><td class="text-right py-0 px-2">65</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">.599</td><td class="text-right py-0 px-2">-3.1</td><td class="text-right py-0 px-2">806</td><td class="text-right py-0 px-2">634</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/cubs" target="_blank" style="color: #2563eb; text-decoration: underline;">Chicago Cubs</a>-w</td><td class="text-right py-0 px-2">92</td><td class="text-right py-0 px-2">70</td><td class="text-right py-0 px-2">5.0</td><td class="text-right py-0 px-2">1</td><td class="text-right py-0 px-2">.568</td><td class="text-right py-0 px-2">-5.0</td><td class="text-right py-0 px-2">793</td><td class="text-right py-0 px-2">649</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/reds" target="_blank" style="color: #2563eb; text-decoration: underline;">Cincinnati Reds</a>-w</td><td class="text-right py-0 px-2">83</td><td class="text-right py-0 px-2">79</td><td class="text-right py-0 px-2">14.0</td><td class="text-right py-0 px-2">4</td><td class="text-right py-0 px-2">.512</td><td class="text-right py-0 px-2">-2.1</td><td class="text-right py-0 px-2">716</td><td class="text-right py-0 px-2">681</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/cardinals" target="_blank" style="color: #2563eb; text-decoration: underline;">St. Louis Cardinals</a></td><td class="text-right py-0 px-2">78</td><td class="text-right py-0 px-2">84</td><td class="text-right py-0 px-2">19.0</td><td class="text-right py-0 px-2">8</td><td class="text-right py-0 px-2">.481</td><td class="text-right py-0 px-2">4.3</td><td class="text-right py-0 px-2">689</td><td class="text-right py-0 px-2">754</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/pirates" target="_blank" style="color: #2563eb; text-decoration: underline;">Pittsburgh Pirates</a></td><td class="text-right py-0 px-2">71</td><td class="text-right py-0 px-2">91</td><td class="text-right py-0 px-2">26.0</td><td class="text-right py-0 px-2">10</td><td class="text-right py-0 px-2">.438</td><td class="text-right py-0 px-2">-1.8</td><td class="text-right py-0 px-2">583</td><td class="text-right py-0 px-2">645</td></tr></tbody></table></div><div class="mb-4"><h3 class="text-lg font-semibold text-gray-800 mb-1">National League West</h3><table class="standings-table w-full text-gray-800 text-sm"><thead><tr class="border-b-2 border-blue-800"><th class="text-left py-1 px-2" style="width: 30%;">Team</th><th class="text-right py-1 px-2" style="width: 7%;">W</th><th class="text-right py-1 px-2" style="width: 7%;">L</th><th class="text-right py-1 px-2" style="width: 7%;">GB</th><th class="text-right py-1 px-2" style="width: 7%;">WC</th><th class="text-right py-1 px-2" style="width: 9%;">PCT</th><th class="text-right py-1 px-2" style="width: 11%;">PythVar</th><th class="text-right py-1 px-2" style="width: 9%;">RS</th><th class="text-right py-1 px-2" style="width: 9%;">RA</th></tr></thead><tbody class="text-sm"><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/dodgers" target="_blank" style="color: #2563eb; text-decoration: underline;">Los Angeles Dodgers</a>-y</td><td class="text-right py-0 px-2">93</td><td class="text-right py-0 px-2">69</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">-</td><td class="text-right py-0 px-2">.574</td><td class="text-right py-0 px-2">-3.1</td><td class="text-right py-0 px-2">825</td><td class="text-right py-0 px-2">683</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/padres" target="_blank" style="color: #2563eb; text-decoration: underline;">San Diego Padres</a>-w</td><td class="text-right py-0 px-2">90</td><td class="text-right py-0 px-2">72</td><td class="text-right py-0 px-2">3.0</td><td class="text-right py-0 px-2">2</td><td class="text-right py-0 px-2">.556</td><td class="text-right py-0 px-2">-0.9</td><td class="text-right py-0 px-2">702</td><td class="text-right py-0 px-2">621</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/giants" target="_blank" style="color: #2563eb; text-decoration: underline;">San Francisco Giants</a></td><td class="text-right py-0 px-2">81</td><td class="text-right py-0 px-2">81</td><td class="text-right py-0 px-2">12.0</td><td class="text-right py-0 px-2">5</td><td class="text-right py-0 px-2">.500</td><td class="text-right py-0 px-2">-2.4</td><td class="text-right py-0 px-2">705</td><td class="text-right py-0 px-2">684</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/az" target="_blank" style="color: #2563eb; text-decoration: underline;">Arizona Diamondbacks</a></td><td class="text-right py-0 px-2">80</td><td class="text-right py-0 px-2">82</td><td class="text-right py-0 px-2">13.0</td><td class="text-right py-0 px-2">6</td><td class="text-right py-0 px-2">.494</td><td class="text-right py-0 px-2">-1.6</td><td class="text-right py-0 px-2">791</td><td class="text-right py-0 px-2">785</td></tr><tr class="hover:bg-blue-50 leading-tight"><td class="py-0 px-2"><a href="https://www.fangraphs.com/teams/rockies" target="_blank" style="color: #2563eb; text-decoration: underline;">Colorado Rockies</a></td><td class="text-right py-0 px-2">43</td><td class="text-right py-0 px-2">119</td><td class="text-right py-0 px-2">50.0</td><td class="text-right py-0 px-2">12</td><td class="text-right py-0 px-2">.265</td><td class="text-right py-0 px-2">1.7</td><td class="text-right py-0 px-2">597</td><td class="text-right py-0 px-2">1021</td></tr></tbody></table></div>
                <div class="footer-note">
                    <strong>z</strong>=Clinched Division &amp; Best Record | <strong>y</strong>=Clinched Division | <strong>w</strong>=Clinched Wild Card<br>
                    WC = Wild Card Rank | PythVar = Actual Wins − Pythagorean Expected Wins
                </div>
            </div>
        </div>
        
        <div class="tab-container">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="switchTab(1)">Run Differential</button>
                <button class="tab-button" onclick="switchTab(2)">Runs Scored</button>
                <button class="tab-button" onclick="switchTab(3)">Runs Allowed</button>
            </div>
            
            <div id="tab1" class="tab-content bg-red-50">
                <h2 style="text-align: center; font-size: 1.5em; margin-bottom: 5px;">Win Expectation: Runs Scored and Runs Allowed</h2>
                <p id="graph1Title" style="text-align: center; color: #666; margin-bottom: 15px;"></p>
                <div class="chart-container">
                    <canvas id="chart1"></canvas>
                </div>
                <div class="graph-info">
                    <p>Better teams (upper right) score more and allow fewer runs</p>
                    <p>Win% lines of .400, .500 and .600 are based on the Pythagorean Formula</p>
                    <p>Hover over a data point to see the team name and wins</p>
                </div>
                <a class="download-link" onclick="downloadChart(1)">Download Graph</a>
                <div class="graph-controls">
                    <div class="about-graph">
                        <details>
                            <summary>About This Graph</summary>
                            <div class="content">
                                <p><strong>Run Differential</strong></p>
                                <p>This graph shows how well each team performed scoring and allowing runs, which are the drivers of baseball success. The Runs Allowed axis (Y axis) is reversed, so that the best defensive teams are at the top and the best scoring teams are on the right.</p>
                                <p>The dotted lines are based on the Pythagorean Theorem (RS²)/(RS²+RA²), which is a good predictor of winning percentage. The lines are drawn at different winning percentages so you can compare teams in different areas of the graph. The best teams will be above the .600 line.</p>
                                <p>If you hover over a datapoint, you'll see the team name and actual wins. The PythVar column in the standings shows the difference between actual wins and Pythagorean wins.</p>
                            </div>
                        </details>
                    </div>
                </div>
            </div>
            
            <div id="tab2" class="tab-content bg-blue-50" style="display: none;">
                <h2 style="text-align: center; font-size: 1.5em; margin-bottom: 5px;">Offensive Profile: OBP and ISO</h2>
                <p id="graph2Title" style="text-align: center; color: #666; margin-bottom: 15px;"></p>
                <div class="chart-container">
                    <canvas id="chart2"></canvas>
                </div>
                <div class="graph-info">
                    <p>Better offensive teams are in the upper right (high OBP and high power)</p>
                    <p>Dotted lines represent league averages</p>
                    <p>Hover over a data point to see the team name and runs scored</p>
                </div>
                <a class="download-link" onclick="downloadChart(2)">Download Graph</a>
                <div class="graph-controls">
                    <div class="about-graph">
                        <details>
                            <summary>About This Graph</summary>
                            <div class="content">
                                <p><strong>How Teams Score Runs</strong></p>
                                <p>This graph examines the two key components of offense: getting on base (OBP) and hitting for power (ISO - Isolated Power). ISO is calculated as slugging percentage minus batting average, measuring extra bases per at-bat.</p>
                                <p>Teams in the upper right excel at both getting on base and hitting for power, producing the most runs. Teams in the lower left struggle with both. The dotted lines show league averages for reference.</p>
                                <p>This helps identify whether a team's offensive success comes from patience at the plate, power hitting, or a combination of both.</p>
                            </div>
                        </details>
                    </div>
                </div>
            </div>
            
            <div id="tab3" class="tab-content bg-green-50" style="display: none;">
                <h2 style="text-align: center; font-size: 1.5em; margin-bottom: 5px;">Pitching & Defense: FIP and DER</h2>
                <p id="graph3Title" style="text-align: center; color: #666; margin-bottom: 15px;"></p>
                <div class="chart-container">
                    <canvas id="chart3"></canvas>
                </div>
                <div class="graph-info">
                    <p>Better pitching teams are on the right; better fielding teams are near the top</p>
                    <p>Dotted lines represent league averages</p>
                    <p>Hover over a data point to see the team name and runs allowed</p>
                </div>
                <a class="download-link" onclick="downloadChart(3)">Download Graph</a>
                <div class="graph-controls">
                    <div class="about-graph">
                        <details>
                            <summary>About This Graph</summary>
                            <div class="content">
                                <p><strong>Separating Pitching and Fielding</strong></p>
                                <p>The easiest way to judge pitching effectiveness is to isolate outcomes that don't involve fielders: strikeouts, walks, and home runs. That's what FIP measures: (HR×13 + BB×3 - K×2) / IP. Lower FIP indicates better pitching.</p>
                                <p>All other batted balls involve fielders. To measure fielding, we use Defensive Efficiency Record (DER), which is the percent of batted balls (excluding home runs) turned into outs by fielders. Higher DER indicates better fielding.</p>
                                <p>The FIP axis is reversed so that better pitching teams are on the right. The best overall teams (upper right) combine strong pitching and fielding.</p>
                            </div>
                        </details>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Leaderboards Section -->
    <div class="container" style="margin-top: 30px;">
        <div class="standings-container">
            <h2 style="text-align: center; margin-bottom: 20px;">Player Leaderboards</h2>
            
            <!-- Batting Leaderboard -->
            <div class="leaderboard-section" style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 10px;">Batting Leaders</h3>
                <div class="leaderboard-controls" style="display: flex; gap: 15px; margin-bottom: 10px; flex-wrap: wrap; align-items: center;">
                    <label>Sort by: 
                        <select id="batterStat" onchange="updateBatterLeaderboard()">
                            <option value="rc" selected>RC</option>
                            <option value="hr">HR</option>
                            <option value="rbi">RBI</option>
                            <option value="r">Runs</option>
                            <option value="h">Hits</option>
                            <option value="sb">SB</option>
                            <option value="avg">AVG</option>
                            <option value="obp">OBP</option>
                            <option value="slg">SLG</option>
                            <option value="ops">OPS</option>
                        </select>
                    </label>
                    <label>League: 
                        <select id="batterLeague" onchange="updateBatterLeaderboard()">
                            <option value="MLB">MLB</option>
                            <option value="AL">AL</option>
                            <option value="NL">NL</option>
                        </select>
                    </label>
                    <label>Show: 
                        <select id="batterCount" onchange="updateBatterLeaderboard()">
                            <option value="5">5</option>
                            <option value="10" selected>10</option>
                            <option value="15">15</option>
                            <option value="20">20</option>
                        </select>
                    </label>
                    <label>
                        <input type="checkbox" id="batterQualified" onchange="updateBatterLeaderboard()"> Qualified only
                    </label>
                    <label>Max age: 
                        <input type="number" id="batterMaxAge" min="18" max="50" value="" placeholder="Any" style="width: 60px;" onchange="updateBatterLeaderboard()">
                    </label>
                </div>
                <table class="standings-table" style="width: 100%;">
                    <thead>
                        <tr class="border-b-2 border-blue-800">
                            <th class="text-left py-1 px-2">Player</th>
                            <th class="text-left py-1 px-2">Team</th>
                            <th class="text-right py-1 px-2">Age</th>
                            <th class="text-right py-1 px-2">G</th>
                            <th class="text-right py-1 px-2">PA</th>
                            <th class="text-right py-1 px-2" id="th-rc">RC</th>
                            <th class="text-right py-1 px-2" id="th-hr">HR</th>
                            <th class="text-right py-1 px-2" id="th-rbi">RBI</th>
                            <th class="text-right py-1 px-2" id="th-r">R</th>
                            <th class="text-right py-1 px-2" id="th-h">H</th>
                            <th class="text-right py-1 px-2" id="th-sb">SB</th>
                            <th class="text-right py-1 px-2" id="th-avg">AVG</th>
                            <th class="text-right py-1 px-2" id="th-obp">OBP</th>
                            <th class="text-right py-1 px-2" id="th-slg">SLG</th>
                            <th class="text-right py-1 px-2" id="th-ops">OPS</th>
                        </tr>
                    </thead>
                    <tbody id="batterLeaderboardBody">
                    </tbody>
                </table>
            </div>
            
            <!-- Pitching Leaderboard -->
            <div class="leaderboard-section">
                <h3 style="margin-bottom: 10px;">Pitching Leaders</h3>
                <div class="leaderboard-controls" style="display: flex; gap: 15px; margin-bottom: 10px; flex-wrap: wrap; align-items: center;">
                    <label>Sort by: 
                        <select id="pitcherStat" onchange="updatePitcherLeaderboard()">
                            <option value="fipar" selected>FIPAR</option>
                            <option value="w">Wins</option>
                            <option value="sv">Saves</option>
                            <option value="k">Strikeouts</option>
                            <option value="era">ERA</option>
                            <option value="whip">WHIP</option>
                            <option value="fip">FIP</option>
                            <option value="ip">IP</option>
                        </select>
                    </label>
                    <label>League: 
                        <select id="pitcherLeague" onchange="updatePitcherLeaderboard()">
                            <option value="MLB">MLB</option>
                            <option value="AL">AL</option>
                            <option value="NL">NL</option>
                        </select>
                    </label>
                    <label>Show: 
                        <select id="pitcherCount" onchange="updatePitcherLeaderboard()">
                            <option value="5">5</option>
                            <option value="10" selected>10</option>
                            <option value="15">15</option>
                            <option value="20">20</option>
                        </select>
                    </label>
                    <label>
                        <input type="checkbox" id="pitcherQualified" onchange="updatePitcherLeaderboard()"> Qualified only
                    </label>
                    <label>Max age: 
                        <input type="number" id="pitcherMaxAge" min="18" max="50" value="" placeholder="Any" style="width: 60px;" onchange="updatePitcherLeaderboard()">
                    </label>
                </div>
                <table class="standings-table" style="width: 100%;">
                    <thead>
                        <tr class="border-b-2 border-blue-800">
                            <th class="text-left py-1 px-2">Player</th>
                            <th class="text-left py-1 px-2">Team</th>
                            <th class="text-right py-1 px-2">Age</th>
                            <th class="text-right py-1 px-2">G</th>
                            <th class="text-right py-1 px-2">IP</th>
                            <th class="text-right py-1 px-2" id="th-fipar">FIPAR</th>
                            <th class="text-right py-1 px-2" id="th-w">W</th>
                            <th class="text-right py-1 px-2" id="th-sv">SV</th>
                            <th class="text-right py-1 px-2" id="th-k">K</th>
                            <th class="text-right py-1 px-2" id="th-era">ERA</th>
                            <th class="text-right py-1 px-2" id="th-whip">WHIP</th>
                            <th class="text-right py-1 px-2" id="th-fip">FIP</th>
                        </tr>
                    </thead>
                    <tbody id="pitcherLeaderboardBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script>
        const alData = ${alTeamsData};
        const nlData = ${nlTeamsData};
        const batterData = ${JSON.stringify(playerStats.batters)};
        const pitcherData = ${JSON.stringify(playerStats.pitchers)};
        let currentLeague = 'AL';
        let chart1, chart2, chart3;
        
        // Plugin to draw team labels with collision detection
        const labelPlugin = {
            afterDatasetsDraw: function(chart) {
                const ctx = chart.ctx;
                const meta = chart.getDatasetMeta(0);
                
                if (!meta.data || meta.data.length === 0) return;
                
                // First pass: calculate initial label positions
                const labels = chart.data.datasets[0].data.map(function(datapoint, index) {
                    const point = meta.data[index];
                    const labelText = datapoint.label || '';
                    
                    ctx.font = 'bold 13px sans-serif';
                    const textMetrics = ctx.measureText(labelText);
                    const textWidth = textMetrics.width;
                    const textHeight = 16;
                    
                    const positions = [
                        { xOffset: 8, yOffset: 18, align: 'left' },
                        { xOffset: 8, yOffset: -8, align: 'left' },
                        { xOffset: -8, yOffset: 18, align: 'right' },
                        { xOffset: -8, yOffset: -8, align: 'right' },
                        { xOffset: 0, yOffset: -20, align: 'center' },
                        { xOffset: 0, yOffset: 28, align: 'center' }
                    ];
                    
                    return {
                        point: point,
                        text: labelText,
                        width: textWidth,
                        height: textHeight,
                        positions: positions,
                        selectedPosition: 0
                    };
                });
                
                function rectanglesOverlap(r1, r2) {
                    return !(r1.right < r2.left || r1.left > r2.right || r1.bottom < r2.top || r1.top > r2.bottom);
                }
                
                function getLabelRect(label, posIndex) {
                    const pos = label.positions[posIndex];
                    const padding = 2;
                    let left;
                    if (pos.align === 'right') {
                        left = label.point.x + pos.xOffset - label.width - padding * 2;
                    } else if (pos.align === 'center') {
                        left = label.point.x + pos.xOffset - label.width / 2 - padding;
                    } else {
                        left = label.point.x + pos.xOffset - padding;
                    }
                    const top = label.point.y + pos.yOffset - label.height + 2;
                    return { left, right: left + label.width + padding * 2, top, bottom: top + label.height, pos };
                }
                
                // Second pass: resolve collisions
                for (let i = 0; i < labels.length; i++) {
                    let foundPosition = false;
                    for (let posIndex = 0; posIndex < labels[i].positions.length && !foundPosition; posIndex++) {
                        const currentRect = getLabelRect(labels[i], posIndex);
                        let hasCollision = false;
                        for (let j = 0; j < i; j++) {
                            const otherRect = getLabelRect(labels[j], labels[j].selectedPosition);
                            if (rectanglesOverlap(currentRect, otherRect)) {
                                hasCollision = true;
                                break;
                            }
                        }
                        if (!hasCollision) {
                            labels[i].selectedPosition = posIndex;
                            foundPosition = true;
                        }
                    }
                    if (!foundPosition) labels[i].selectedPosition = 0;
                }
                
                // Third pass: draw labels
                labels.forEach(function(label) {
                    const pos = label.positions[label.selectedPosition];
                    const rect = getLabelRect(label, label.selectedPosition);
                    
                    ctx.save();
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                    ctx.fillRect(rect.left, rect.top, rect.right - rect.left, rect.bottom - rect.top);
                    ctx.font = 'bold 13px sans-serif';
                    ctx.fillStyle = '#000';
                    ctx.textAlign = pos.align;
                    ctx.fillText(label.text, label.point.x + pos.xOffset, label.point.y + pos.yOffset);
                    ctx.restore();
                });
            }
        };
        
        function updateLeague() {
            const selected = document.querySelector('input[name="league"]:checked').value;
            currentLeague = selected;
            
            if (selected === 'AL') {
                document.getElementById('alStandings').style.display = 'block';
                document.getElementById('nlStandings').style.display = 'none';
            } else {
                document.getElementById('alStandings').style.display = 'none';
                document.getElementById('nlStandings').style.display = 'block';
            }
            
            updateAllCharts();
        }
        
        function switchTab(tabNum) {
            // Hide all tabs
            for (let i = 1; i <= 3; i++) {
                document.getElementById('tab' + i).style.display = 'none';
                document.querySelectorAll('.tab-button')[i - 1].classList.remove('active');
            }
            
            // Show selected tab
            document.getElementById('tab' + tabNum).style.display = 'block';
            document.querySelectorAll('.tab-button')[tabNum - 1].classList.add('active');
        }
        
        function updateAllCharts() {
            updateChart1();
            updateChart2();
            updateChart3();
        }
        
        function calculateIsobar(teams, pythPct) {
            const rs = teams.map(t => t.rsPerGame * t.gamesPlayed);
            const ra = teams.map(t => t.raPerGame * t.gamesPlayed);
            const minR = Math.min(...rs);
            const maxR = Math.max(...rs);
            const minRA = Math.min(...ra);
            const maxRA = Math.max(...ra);
            
            const points = [];
            for (let r = minR - 50; r <= maxR + 50; r += 10) {
                const calcRA = r * Math.sqrt((1 - pythPct) / pythPct);
                if (calcRA >= minRA - 50 && calcRA <= maxRA + 50) {
                    points.push({ x: r, y: calcRA });
                }
            }
            return points;
        }
        
        function updateChart1() {
            const teams = currentLeague === 'AL' ? alData : nlData;
            document.getElementById('graph1Title').textContent = currentLeague + ' - 2025';
            
            const ctx = document.getElementById('chart1');
            if (chart1) chart1.destroy();
            
            const teamPoints = teams.map(t => ({
                x: t.rs,
                y: t.ra,
                label: t.abbreviation,
                wins: t.w
            }));
            
            const isobar400 = calculateIsobar(teams, 0.400);
            const isobar500 = calculateIsobar(teams, 0.500);
            const isobar600 = calculateIsobar(teams, 0.600);
            
            chart1 = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'Teams',
                            data: teamPoints,
                            backgroundColor: '#ef4444',
                            borderColor: '#ef4444',
                            pointRadius: 6,
                            pointHoverRadius: 8
                        },
                        {
                            label: '.400',
                            data: isobar400,
                            type: 'line',
                            borderColor: '#888',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            fill: false,
                            showLine: true
                        },
                        {
                            label: '.500',
                            data: isobar500,
                            type: 'line',
                            borderColor: '#888',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            fill: false,
                            showLine: true
                        },
                        {
                            label: '.600',
                            data: isobar600,
                            type: 'line',
                            borderColor: '#888',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            fill: false,
                            showLine: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 1500,
                        easing: 'easeOutQuart'
                    },
                    layout: {
                        padding: { top: 30, right: 50, bottom: 20, left: 20 }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return context[0].raw.label;
                                },
                                label: function(context) {
                                    return [
                                        'Wins: ' + context.raw.wins,
                                        'RS: ' + context.raw.x,
                                        'RA: ' + context.raw.y
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 'Runs Scored', font: { size: 14, weight: 'bold' } },
                            grid: { color: '#e0e0e0' }
                        },
                        y: {
                            title: { display: true, text: 'Runs Allowed', font: { size: 14, weight: 'bold' } },
                            reverse: true,
                            grid: { color: '#e0e0e0' }
                        }
                    }
                },
                plugins: [labelPlugin]
            });
        }
        
        function updateChart2() {
            const teams = currentLeague === 'AL' ? alData : nlData;
            document.getElementById('graph2Title').textContent = currentLeague + ' - 2025';
            
            const ctx = document.getElementById('chart2');
            if (chart2) chart2.destroy();
            
            const teamPoints = teams.map(t => ({
                x: t.obp,
                y: t.iso,
                label: t.abbreviation,
                rs: t.rs
            }));
            
            // Calculate league averages
            const avgOBP = teams.reduce((sum, t) => sum + t.obp, 0) / teams.length;
            const avgISO = teams.reduce((sum, t) => sum + t.iso, 0) / teams.length;
            
            const minOBP = Math.min(...teams.map(t => t.obp));
            const maxOBP = Math.max(...teams.map(t => t.obp));
            const minISO = Math.min(...teams.map(t => t.iso));
            const maxISO = Math.max(...teams.map(t => t.iso));
            
            chart2 = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'Teams',
                            data: teamPoints,
                            backgroundColor: '#3b82f6',
                            borderColor: '#3b82f6',
                            pointRadius: 6,
                            pointHoverRadius: 8
                        },
                        {
                            label: 'Avg OBP',
                            data: [{ x: avgOBP, y: minISO }, { x: avgOBP, y: maxISO }],
                            type: 'line',
                            borderColor: '#888',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            fill: false,
                            showLine: true
                        },
                        {
                            label: 'Avg ISO',
                            data: [{ x: minOBP, y: avgISO }, { x: maxOBP, y: avgISO }],
                            type: 'line',
                            borderColor: '#888',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            fill: false,
                            showLine: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 1500,
                        easing: 'easeOutQuart'
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return context[0].raw.label;
                                },
                                label: function(context) {
                                    return [
                                        'Runs: ' + context.raw.rs,
                                        'OBP: ' + context.raw.x.toFixed(3),
                                        'ISO: ' + context.raw.y.toFixed(3)
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 'On-Base Percentage (OBP)', font: { size: 14, weight: 'bold' } },
                            grid: { color: '#e0e0e0' }
                        },
                        y: {
                            title: { display: true, text: 'Isolated Power (ISO)', font: { size: 14, weight: 'bold' } },
                            grid: { color: '#e0e0e0' }
                        }
                    }
                },
                plugins: [labelPlugin]
            });
        }
        
        function updateChart3() {
            const teams = currentLeague === 'AL' ? alData : nlData;
            document.getElementById('graph3Title').textContent = currentLeague + ' - 2025';
            
            const ctx = document.getElementById('chart3');
            if (chart3) chart3.destroy();
            
            const teamPoints = teams.map(t => ({
                x: t.fip,
                y: t.der,
                label: t.abbreviation,
                ra: t.ra
            }));
            
            // Calculate league averages
            const avgFIP = teams.reduce((sum, t) => sum + t.fip, 0) / teams.length;
            const avgDER = teams.reduce((sum, t) => sum + t.der, 0) / teams.length;
            
            const minFIP = Math.min(...teams.map(t => t.fip));
            const maxFIP = Math.max(...teams.map(t => t.fip));
            const minDER = Math.min(...teams.map(t => t.der));
            const maxDER = Math.max(...teams.map(t => t.der));
            
            chart3 = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'Teams',
                            data: teamPoints,
                            backgroundColor: '#10b981',
                            borderColor: '#10b981',
                            pointRadius: 6,
                            pointHoverRadius: 8
                        },
                        {
                            label: 'Avg FIP',
                            data: [{ x: avgFIP, y: minDER }, { x: avgFIP, y: maxDER }],
                            type: 'line',
                            borderColor: '#888',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            fill: false,
                            showLine: true
                        },
                        {
                            label: 'Avg DER',
                            data: [{ x: minFIP, y: avgDER }, { x: maxFIP, y: avgDER }],
                            type: 'line',
                            borderColor: '#888',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            fill: false,
                            showLine: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 1500,
                        easing: 'easeOutQuart'
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return context[0].raw.label;
                                },
                                label: function(context) {
                                    return [
                                        'Runs Allowed: ' + context.raw.ra,
                                        'FIP: ' + context.raw.x.toFixed(2),
                                        'DER: ' + context.raw.y.toFixed(3)
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 'FIP (Fielding Independent Pitching)', font: { size: 14, weight: 'bold' } },
                            reverse: true,
                            grid: { color: '#e0e0e0' }
                        },
                        y: {
                            title: { display: true, text: 'DER (Defensive Efficiency Record)', font: { size: 14, weight: 'bold' } },
                            grid: { color: '#e0e0e0' }
                        }
                    }
                },
                plugins: [labelPlugin]
            });
        }
        
        function downloadChart(chartNum) {
            let chart, title, subtitle, canvasId;
            if (chartNum === 1) {
                chart = chart1;
                canvasId = 'chart1';
                title = 'Run Differential: 2025';
                subtitle = 'Runs Scored vs Runs Allowed';
            } else if (chartNum === 2) {
                chart = chart2;
                canvasId = 'chart2';
                title = 'Offensive Profile: 2025';
                subtitle = 'OBP vs ISO';
            } else if (chartNum === 3) {
                chart = chart3;
                canvasId = 'chart3';
                title = 'Pitching & Defense: 2025';
                subtitle = 'FIP vs DER';
            }
            
            if (chart) {
                const canvas = document.getElementById(canvasId);
                const tempCanvas = document.createElement('canvas');
                const ctx = tempCanvas.getContext('2d');
                
                tempCanvas.width = canvas.width;
                tempCanvas.height = canvas.height + 110;
                
                // White background
                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
                
                // Title
                ctx.fillStyle = '#1f2937';
                ctx.font = 'bold 24px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(title, tempCanvas.width / 2, 40);
                
                // Subtitle
                ctx.fillStyle = '#6b7280';
                ctx.font = '18px Arial';
                ctx.fillText(subtitle + ' - ' + currentLeague, tempCanvas.width / 2, 70);
                
                // Draw the chart
                ctx.drawImage(canvas, 0, 110);
                
                const link = document.createElement('a');
                link.download = 'baseball-graph-' + chartNum + '-2025.png';
                link.href = tempCanvas.toDataURL();
                link.click();
            }
        }
        
        // Leaderboard functions
        function formatRate(val) {
            return val.toFixed(3).replace(/^0/, '');
        }
        
        function formatStat(val, stat) {
            const rateStats = ['avg', 'obp', 'slg', 'ops'];
            const twoDecimalStats = ['era', 'whip', 'fip'];
            const oneDecimalStats = ['ip'];
            
            if (rateStats.includes(stat)) {
                return formatRate(val);
            } else if (twoDecimalStats.includes(stat)) {
                return val.toFixed(2);
            } else if (oneDecimalStats.includes(stat)) {
                return val.toFixed(1);
            }
            return val;
        }
        
        function updateBatterLeaderboard() {
            const stat = document.getElementById('batterStat').value;
            const league = document.getElementById('batterLeague').value;
            const count = parseInt(document.getElementById('batterCount').value);
            const qualifiedOnly = document.getElementById('batterQualified').checked;
            const maxAge = document.getElementById('batterMaxAge').value ? parseInt(document.getElementById('batterMaxAge').value) : null;
            
            // Filter by league
            let filtered = batterData.filter(p => league === 'MLB' || p.league === league);
            
            // Filter by age
            if (maxAge) {
                filtered = filtered.filter(p => p.age && p.age <= maxAge);
            }
            
            // Filter by qualifier (3.1 PA per team game = ~502 PA for full season, scale by games played)
            if (qualifiedOnly) {
                // Use 3.1 PA per team game as qualifier
                const qualifyingPA = 502; // Full season qualifier
                filtered = filtered.filter(p => p.pa >= qualifyingPA * 0.5); // At least half-season
            }
            
            // Sort - descending for most stats, but some may need ascending
            const ascending = false; // All batter stats are "higher is better"
            filtered.sort((a, b) => ascending ? a[stat] - b[stat] : b[stat] - a[stat]);
            
            // Take top N
            const leaders = filtered.slice(0, count);
            
            // Highlight the sorted column
            ['rc', 'hr', 'rbi', 'r', 'h', 'sb', 'avg', 'obp', 'slg', 'ops'].forEach(s => {
                const th = document.getElementById('th-' + s);
                if (th) th.style.backgroundColor = (s === stat) ? '#fef3c7' : '';
            });
            
            // Build table rows
            const tbody = document.getElementById('batterLeaderboardBody');
            tbody.innerHTML = leaders.map(p => {
                const hs = 'background-color: #fef3c7; font-weight: bold;';
                let row = '<tr class="hover:bg-blue-50">';
                row += '<td class="py-1 px-2">' + p.name + '</td>';
                row += '<td class="py-1 px-2">' + p.teamAbbr + '</td>';
                row += '<td class="text-right py-1 px-2">' + (p.age || '') + '</td>';
                row += '<td class="text-right py-1 px-2">' + p.g + '</td>';
                row += '<td class="text-right py-1 px-2">' + p.pa + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'rc' ? hs : '') + '">' + p.rc + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'hr' ? hs : '') + '">' + p.hr + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'rbi' ? hs : '') + '">' + p.rbi + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'r' ? hs : '') + '">' + p.r + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'h' ? hs : '') + '">' + p.h + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'sb' ? hs : '') + '">' + p.sb + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'avg' ? hs : '') + '">' + formatRate(p.avg) + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'obp' ? hs : '') + '">' + formatRate(p.obp) + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'slg' ? hs : '') + '">' + formatRate(p.slg) + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'ops' ? hs : '') + '">' + formatRate(p.ops) + '</td>';
                row += '</tr>';
                return row;
            }).join('');
        }
        
        function updatePitcherLeaderboard() {
            const stat = document.getElementById('pitcherStat').value;
            const league = document.getElementById('pitcherLeague').value;
            const count = parseInt(document.getElementById('pitcherCount').value);
            const qualifiedOnly = document.getElementById('pitcherQualified').checked;
            const maxAge = document.getElementById('pitcherMaxAge').value ? parseInt(document.getElementById('pitcherMaxAge').value) : null;
            
            // Filter by league
            let filtered = pitcherData.filter(p => league === 'MLB' || p.league === league);
            
            // Filter by age
            if (maxAge) {
                filtered = filtered.filter(p => p.age && p.age <= maxAge);
            }
            
            // Filter by qualifier (1 IP per team game = ~162 IP for full season)
            if (qualifiedOnly) {
                const qualifyingIP = 162;
                filtered = filtered.filter(p => p.ip >= qualifyingIP * 0.5);
            }
            
            // Sort - ascending for ERA, WHIP, FIP; descending for others
            const ascending = ['era', 'whip', 'fip'].includes(stat);
            filtered.sort((a, b) => ascending ? a[stat] - b[stat] : b[stat] - a[stat]);
            
            // Take top N
            const leaders = filtered.slice(0, count);
            
            // Highlight the sorted column
            ['fipar', 'w', 'sv', 'k', 'era', 'whip', 'fip'].forEach(s => {
                const th = document.getElementById('th-' + s);
                if (th) th.style.backgroundColor = (s === stat) ? '#fef3c7' : '';
            });
            
            // Build table rows
            const tbody = document.getElementById('pitcherLeaderboardBody');
            tbody.innerHTML = leaders.map(p => {
                const hs = 'background-color: #fef3c7; font-weight: bold;';
                let row = '<tr class="hover:bg-blue-50">';
                row += '<td class="py-1 px-2">' + p.name + '</td>';
                row += '<td class="py-1 px-2">' + p.teamAbbr + '</td>';
                row += '<td class="text-right py-1 px-2">' + (p.age || '') + '</td>';
                row += '<td class="text-right py-1 px-2">' + p.g + '</td>';
                row += '<td class="text-right py-1 px-2">' + p.ip.toFixed(1) + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'fipar' ? hs : '') + '">' + p.fipar + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'w' ? hs : '') + '">' + p.w + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'sv' ? hs : '') + '">' + p.sv + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'k' ? hs : '') + '">' + p.k + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'era' ? hs : '') + '">' + p.era.toFixed(2) + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'whip' ? hs : '') + '">' + p.whip.toFixed(2) + '</td>';
                row += '<td class="text-right py-1 px-2" style="' + (stat === 'fip' ? hs : '') + '">' + p.fip.toFixed(2) + '</td>';
                row += '</tr>';
                return row;
            }).join('');
        }
        
        // Initialize on page load
        updateAllCharts();
        updateBatterLeaderboard();
        updatePitcherLeaderboard();
    </script>
</body>
</html>